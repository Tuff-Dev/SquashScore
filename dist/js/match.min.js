function Match(e,t,a,s,h,c,n,i){this.p1Name=e,this.p2Name=t,this.p1Handicap=a,this.p2Handicap=s,this.p1MatchScore=this.p1Handicap,this.p2MatchScore=this.p2Handicap,this.gameType=h,this.bestOf=c,this.playTo=n,this.games=i,selectServingPlayer(this),this.point=function(e){"PAR"===h?e?this.games[this.games.length-1].p1Score+=1:this.games[this.games.length-1].p2Score+=1:e?this.games[this.games.length-1].p1Serve&&(this.games[this.games.length-1].p1Score+=1):this.games[this.games.length-1].p1Serve||(this.games[this.games.length-1].p2Score+=1),updateScore();var t=!1;(this.games[this.games.length-1].p1Score>=this.playTo||this.games[this.games.length-1].p2Score>=this.playTo)&&(this.games[this.games.length-1].twoClear?(this.games[this.games.length-1].p1Score-this.games[this.games.length-1].p2Score>=2||this.games[this.games.length-1].p2Score-this.games[this.games.length-1].p1Score>=2)&&(t=!0):t=!0),t?(this.games[this.games.length-1].p1Score>this.games[this.games.length-1].p2Score?this.games[this.games.length-1].points.push(new Point(e,!0)):this.games[this.games.length-1].points.push(new Point(e,!1)),endOfGameFn(),updateScore()):(this.games[this.games.length-1].points.push(new Point(e)),"PAR"!==currentMatch.gameType&&(currentMatch.games[currentMatch.games.length-1].p1Score!==currentMatch.games[currentMatch.games.length-1].p2Score||currentMatch.games[currentMatch.games.length-1].p1Score!==currentMatch.playTo-1||currentMatch.games[currentMatch.games.length-1].twoPointsChosen||selectTwoPointsClear()),"PAR"===this.gameType?e&&!this.games[this.games.length-1].p1Serve?(this.games[this.games.length-1].p1Serve=!0,displayHandOutModal()):!e&&this.games[this.games.length-1].p1Serve?(this.games[this.games.length-1].p1Serve=!1,displayHandOutModal()):switchServingSide():e?(this.games[this.games.length-1].p1Serve?switchServingSide():(this.games[this.games.length-1].p1Serve=!0,displayHandOutModal()),this.games[this.games.length-1].p1Serve=!0):(this.games[this.games.length-1].p1Serve?(this.games[this.games.length-1].p1Serve=!1,displayHandOutModal()):switchServingSide(),this.games[this.games.length-1].p1Serve=!1)),saveMatch()},this.undoLastPoint=function(){if(1===this.games.length&&1===this.games[this.games.length-1].points.length)return!1;1===this.games[this.games.length-1].points.length&&(this.games.pop(),this.games[this.games.length-1].points[this.games[this.games.length-1].points.length-1].p1GameWin?this.p1MatchScore-=1:this.p2MatchScore-=1),this.games[this.games.length-1].p1Serve=this.games[this.games.length-1].points[this.games[this.games.length-1].points.length-1].p1Serve,this.games[this.games.length-1].serveLeftRight=this.games[this.games.length-1].points[this.games[this.games.length-1].points.length-1].serveLeftRight,"L"===this.games[this.games.length-1].serveLeftRight?processHandoutSelection(!0):processHandoutSelection(!1),this.games[this.games.length-1].points.pop(),this.games[this.games.length-1].p1Score=this.games[this.games.length-1].points[this.games[this.games.length-1].points.length-1].p1Score,this.games[this.games.length-1].p2Score=this.games[this.games.length-1].points[this.games[this.games.length-1].points.length-1].p2Score,updateScore(),saveMatch()}}function Game(e,t){this.gameNumber=e,this.p1Score=0,this.p2Score=0,this.gameOver=!1,this.p1Serve=!0,this.serveLeftRight="L",this.twoClear="PAR"===t,this.points=[],this.points.push(new Point),this.points[0].p1Score=0,this.points[0].p2Score=0}function Point(e,t){this.p1winner=e,this.p1Score=currentMatch.games[currentMatch.games.length-1].p1Score,this.p2Score=currentMatch.games[currentMatch.games.length-1].p2Score,this.p1Serve=currentMatch.games[currentMatch.games.length-1].p1Serve,this.serveLeftRight=currentMatch.games[currentMatch.games.length-1].serveLeftRight,this.p1GameWin=t}function displayHandOutModal(){$(".content").addClass("blur"),$("#handOutTxt").show(),$("#handoutSelect").show(),$("#serveSelect").hide(),$("#modal").fadeIn(),$("#handoutSelect .options .left").click(function(){hideModal(),processHandoutSelection(!0)}),$("#handoutSelect .options .right").click(function(){hideModal(),processHandoutSelection(!1)})}function hideModal(){$("#modal").hide(),$(".content").removeClass("blur")}function switchServingSideModal(){$(".content").addClass("blur"),$("#handOutTxt").hide(),$("#handoutSelect").show(),$("#serveSelect").hide(),$("#modal").fadeIn(),$("#handoutSelect .options .left").click(function(){hideModal(),processHandoutSelection(!0)}),$("#handoutSelect .options .right").click(function(){hideModal(),processHandoutSelection(!1)})}function selectServingPlayer(e){$(".content").addClass("blur"),$("#handoutSelect").hide(),$("#serveSelect").show(),$("#selectP1Name").text(e.p1Name),$("#selectP2Name").text(e.p2Name),$("#modal").fadeIn(),$("#serveSelect .options .left").click(function(){hideModal(),currentMatch.games[currentMatch.games.length-1].p1Serve=!0,setTimeout(displayHandOutModal(),2e3)}),$("#serveSelect .options .right").click(function(){hideModal(),currentMatch.games[currentMatch.games.length-1].p1Serve=!1,setTimeout(displayHandOutModal(),2e3)})}function selectTwoPointsClear(){$(".content").addClass("blur"),$("#two-clear-modal").fadeIn(),$("#twoClearSelect .options .left").click(function(){$("#two-clear-modal").hide(),$(".content").removeClass("blur"),currentMatch.games[currentMatch.games.length-1].twoPointsChosen=!0,currentMatch.games[currentMatch.games.length-1].twoClear=!0}),$("#twoClearSelect .options .right").click(function(){$("#two-clear-modal").hide(),$(".content").removeClass("blur"),currentMatch.games[currentMatch.games.length-1].twoPointsChosen=!0,currentMatch.games[currentMatch.games.length-1].twoClear=!1})}function updateScore(){$("#p1GameScore").text(currentMatch.games[currentMatch.games.length-1].p1Score),$("#p2GameScore").text(currentMatch.games[currentMatch.games.length-1].p2Score),$("#p1MatchScore").text(currentMatch.p1MatchScore),$("#p2MatchScore").text(currentMatch.p2MatchScore)}function endOfGameFn(){if(p1WinLastGame=!1,currentMatch.games[currentMatch.games.length-1].p1Score>=currentMatch.games[currentMatch.games.length-1].p2Score?(p1WinLastGame=!0,currentMatch.p1MatchScore+=1):currentMatch.p2MatchScore+=1,saveMatch(),updateScore(),currentMatch.p1MatchScore>currentMatch.bestOf/2)currentMatch.matchOver=!0,saveMatch(),window.location.href="match-over.html";else if(currentMatch.p2MatchScore>currentMatch.bestOf/2)currentMatch.matchOver=!0,saveMatch(),window.location.href="match-over.html";else{const e=currentMatch.games.length;currentMatch.games.push(new Game(e+1)),p1WinLastGame?currentMatch.games[currentMatch.games.length-1].p1Serve=!0:currentMatch.games[currentMatch.games.length-1].p1Serve=!1,"PAR"===currentMatch.gameType&&(currentMatch.games[currentMatch.games.length-1].twoClear=!0),displayHandOutModal()}}function processHandoutSelection(e){$("#p1Left").addClass("hide"),$("#p2Left").addClass("hide"),$("#p1Right").addClass("hide"),$("#p2Right").addClass("hide"),e?(currentMatch.games[currentMatch.games.length-1].serveLeftRight="L",!0===currentMatch.games[currentMatch.games.length-1].p1Serve?$("#p1Left").removeClass("hide"):$("#p2Left").removeClass("hide")):(currentMatch.games[currentMatch.games.length-1].serveLeftRight="R",!0===currentMatch.games[currentMatch.games.length-1].p1Serve?$("#p1Right").removeClass("hide"):$("#p2Right").removeClass("hide"))}function switchServingSide(){"R"===currentMatch.games[currentMatch.games.length-1].serveLeftRight?(currentMatch.games[currentMatch.games.length-1].serveLeftRight="L",processHandoutSelection(!0)):(currentMatch.games[currentMatch.games.length-1].serveLeftRight="R",processHandoutSelection(!1))}function saveMatch(){let e=JSON.stringify(currentMatch);localStorage.setItem("savedMatch",e)}function loadMatch(){const e=localStorage.getItem("savedMatch");null===e&&(window.location.href="new-match.html");const t=JSON.parse(e);t.matchOver&&(window.location.href="match-over.html"),this.currentMatch=new Match(t.p1Name,t.p2Name,t.p1Handicap,t.p2Handicap,t.gameType,t.bestOf,t.playTo,t.games),this.currentMatch.p1MatchScore=t.p1MatchScore,this.currentMatch.p2MatchScore=t.p2MatchScore,$("#player1Name").text(this.currentMatch.p1Name),$("#player2Name").text(this.currentMatch.p2Name)}function endMatch(){currentMatch.matchOver=!0,saveMatch(),window.location.href="match-over.html"}var currentMatch;$(document).ready(function(e){loadMatch(),updateScore(),$(".point-buttons__left").click(function(){currentMatch.point(!0)}),$(".point-buttons__right").click(function(){currentMatch.point(!1)}),$("#switchServingSideBtn").click(function(){switchServingSideModal()}),$("#undoLastPointBtn").click(function(){currentMatch.undoLastPoint()}),$("#endMatch").click(function(){endMatch()}),$("#switchServingPlayerBtn").click(function(){selectServingPlayer(currentMatch)})});